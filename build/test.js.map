{"version":3,"sources":["webpack:///webpack/bootstrap 27f7fd81ca002d1c469c","webpack:///external \"@reactivex/rxjs\"","webpack:///./src/router.ts","webpack:///./src/server.ts","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///external \"webpack-node-utils\"","webpack:///./src/test.ts"],"names":[],"mappings":"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","file":"test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 27f7fd81ca002d1c469c","module.exports = require(\"@reactivex/rxjs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@reactivex/rxjs\"\n// module id = 0\n// module chunks = 0","import { IncomingMessage, ServerResponse } from 'http';\r\nimport { Observable } from '@reactivex/rxjs';\r\nimport { readdir, readFile } from 'fs-extra';\r\nimport * as Path from 'path';\r\nimport * as webpack from 'webpack';\r\nconst wpnu = require('webpack-node-utils');\r\n\r\nexport class Router {\r\n    routes$: Observable<Route>;\r\n    constructor(routes: Route[]) {\r\n        this.routes$ = Observable.from(routes);\r\n}\r\n\r\n    match(req: IncomingMessage): Observable<Route> {\r\n        return this.routes$.filter((r: Route) => r.path === req.url);\r\n    }\r\n}\r\n\r\nexport interface Route {\r\n    path: string;\r\n    handler: (req: IncomingMessage, res: ServerResponse) => void;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/router.ts","import { Observable, Observer } from '@reactivex/rxjs';\r\nimport { createServer, ServerRequest, ServerResponse, Server as HttpServer, IncomingMessage, request, RequestOptions } from 'http';\r\nimport { createServer as createSSLServer, Server as HttpsServer, request as secureRequest } from 'https';\r\n\r\nexport class Server {\r\n    constructor(private protocol: string = 'http') {\r\n        //\r\n    }\r\n\r\n    server(port: number, protocol: string = this.protocol) {\r\n        return Observable.create((observer: Observer<{req: IncomingMessage, res: ServerResponse}>) => {\r\n            let server = protocol === 'http' ? this.getHttpServer(observer) : this.getHttpsServer(observer);\r\n\r\n            server.listen(port);\r\n\r\n            return () => {\r\n                observer.complete();\r\n                server.close();\r\n            }\r\n        });\r\n    }\r\n\r\n    getJSON(options: RequestOptions) {\r\n        return Observable.create((observer) => {\r\n            let req = this.protocol === 'http' ? this.getRequest(options, observer) : this.getSecureRequest(options, observer);\r\n        });\r\n    }\r\n\r\n    private getRequest(options: RequestOptions, observer: Observer<any>) {\r\n        let req = request(options, (res: IncomingMessage) => {\r\n            let rawData: string = '';\r\n            res.on('data', (chunk: string) => rawData += chunk);\r\n            res.on('end', () => {\r\n                let data: any;\r\n                try {\r\n                    data = JSON.parse(rawData);\r\n                } catch (error) {\r\n                    observer.error(error);\r\n                }\r\n\r\n                observer.next(data);\r\n                observer.complete();\r\n            });\r\n        });\r\n\r\n        req.on('error', (err) => observer.error(err));\r\n        req.end();\r\n    }\r\n\r\n    private getSecureRequest(options: RequestOptions, observer: Observer<any>) {\r\n        let req = secureRequest(options, (res: IncomingMessage) => {\r\n            let rawData: string = '';\r\n            res.on('data', (chunk: string) => rawData += chunk);\r\n            res.on('end', () => {\r\n                let data: any;\r\n                try {\r\n                    data = JSON.parse(rawData);\r\n                } catch (error) {\r\n                    observer.error(error);\r\n                }\r\n\r\n                observer.next(data);\r\n                observer.complete();\r\n            });\r\n        });\r\n    }\r\n\r\n    private getHttpServer(observer: Observer<{req: IncomingMessage, res: ServerResponse}>): HttpServer {\r\n        let server: HttpServer = createServer((req: IncomingMessage, res: ServerResponse) => {\r\n            observer.next({req: req, res: res});\r\n        });\r\n        \r\n        return server;\r\n    }\r\n\r\n    private getHttpsServer(observer: Observer<{req: IncomingMessage, res: ServerResponse}>): HttpsServer {\r\n        let server: HttpsServer = createSSLServer((req: IncomingMessage, res: ServerResponse) => {\r\n            observer.next({req: req, res: res});\r\n        });\r\n        return server;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/server.ts","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"webpack-node-utils\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-node-utils\"\n// module id = 5\n// module chunks = 0","import { Server } from './server';\r\nimport { Observable } from '@reactivex/rxjs';\r\nimport { Route, Router } from './router';\r\nimport { IncomingMessage, ServerResponse } from 'http';\r\nimport * as Path from 'path';\r\nimport { main } from '../routes';\r\n\r\nconst server: Server = new Server();\r\nconst router: Router = new Router('routes');\r\nserver.server(3000)\r\n.map((r: {req: IncomingMessage, res: ServerResponse}) => router.match(r.req))\r\n.subscribe((req) => {\r\n    console.log(req);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/test.ts"],"sourceRoot":""}